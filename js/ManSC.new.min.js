var ManSC=function(clientID,opts){function manSC(){clientID&&(client_ID=clientID,SC.initialize({client_id:client_ID})),opts&&(elements=opts),publicFunctions=this}function getVolume(){return elements.volume.slider("option","value")}function writeTrackInfoOnScreen(){elements.name.text(currentTrack.title).attr("title",currentTrack.title),elements.artist.text(currentTrack.user.username).attr("title",currentTrack.user.username),elements.cover.attr("src",(currentTrack.artwork_url||"images/empty-vinil.png").replace("large",coverSize)),elements.coverShadow.attr("src",(currentTrack.artwork_url||"images/empty-vinil.png").replace("large",coverSize))}function trackTimer(){var currentTime,currentSec,currentMin,currentHr,currentTimeFormated,currentPos;return setInterval(function(){currentTime=soundMan.position,currentSec=Math.floor(currentTime/1e3%60),currentMin=Math.floor(currentTime/6e4%60),currentHr=Math.floor(currentTime/36e5%60),currentPos=100*currentTime/soundMan.durationEstimate,currentTimeFormated=(currentHr?currentHr+":":"")+(currentHr?formatTwoNumbers(currentMin):currentMin)+":"+formatTwoNumbers(currentSec),elements.timeBar.slider({value:currentPos}),elements.timeCurrent.text(currentTimeFormated)},500)}function formatTwoNumbers(_num){return 1===_num.toString().length?"0"+_num:_num}function isEmpty(obj){for(var i in obj)if(obj.hasOwnProperty(i))return!1;return!0}function calcTrackEstimatedDuration(){function calcDuration(){duration=soundMan.durationEstimate,durationSec=Math.floor(duration/1e3%60),durationMin=Math.floor(duration/6e4%60),durationHrs=Math.floor(duration/36e5%60),durationFormated=(durationHrs?durationHrs+":":"")+(durationHrs?formatTwoNumbers(durationMin):durationMin)+":"+formatTwoNumbers(durationSec),elements.duration.text(durationFormated)}var duration,durationSec,durationMin,durationHrs,durationFormated;return setInterval(function(){calcDuration()},500),setInterval(function(){calcDuration()},5e3)}var client_ID=null,elements={},soundMan=null,currentTrack=null,currentPlaylist=null,viewedPlaylist=null,timers={},coverSize="t200x200",publicFunctions=null;return manSC.prototype.play=function(_id){var promise=$.Deferred();isEmpty(viewedPlaylist)||viewedPlaylist.title!==(currentPlaylist?currentPlaylist.title:"")&&(currentPlaylist=viewedPlaylist,viewedPlaylist={}),soundMan&&(soundMan.stop(),soundMan.unload()),SC.stream(_id,{autoPlay:!0,volume:getVolume(),onfinish:function(){$("[rel='"+_id+"']").removeClass("selected"),$("[rel='"+_id+"']").find("span").first().removeClass("play"),publicFunctions.next(),promise.resolve()},ondataerror:function(){console.log("error")}},function(data){var index="";soundMan=data,currentTrack=currentPlaylist.tracks.filter(function(el,i){return el.id===_id?(index=i,el):void 0})[0],currentPlaylist.index=index,$("[rel='"+_id+"']").addClass("selected"),$("[rel='"+_id+"']").find("span").first().removeClass("pause").addClass("play"),writeTrackInfoOnScreen(),timers.trackTime=trackTimer(),timers.trackDuration=calcTrackEstimatedDuration()})},manSC.prototype.playToggle=function(){soundMan&&(soundMan.paused?($("[rel='"+currentTrack.id+"']").find("span").first().removeClass("pause").addClass("play"),soundMan.resume()):($("[rel='"+currentTrack.id+"']").find("span").first().removeClass("play").addClass("pause"),soundMan.pause()))},manSC.prototype.previous=function(){currentPlaylist.index>0&&this.play(currentPlaylist.tracks[--currentPlaylist.index].id)},manSC.prototype.next=function(){currentPlaylist.index<currentPlaylist.tracks.length-1&&this.play(currentPlaylist.tracks[++currentPlaylist.index].id)},manSC.prototype.setPosition=function(seconds){soundMan&&soundMan.setPosition(seconds)},manSC.prototype.showInPlaylistPanel=function(title,data){var html="";$.each(data,function(index,val){html+="<li rel='"+val.id+"'><span class='checked'></span><span><div>"+val.title+"</div></span></li>"}),elements.playlist.html(html),viewedPlaylist={},viewedPlaylist.title=title,viewedPlaylist.tracks=data},manSC.prototype.setVolume=function(vol){soundMan&&soundMan.setVolume(vol)},manSC.prototype.getDuration=function(){return soundMan.durationEstimate},new manSC};
//# sourceMappingURL=ManSC.new.min.map